import{d as m,u,s as _,o as c,c as d,a as s,A as b,e as w,v as p,y as L,k as S,p as y,l as v,_ as T}from"./index-f321bc63.js";import{b as N,d as O}from"./function-call-5517af3d.js";const r=a=>(y("data-v-a68a29a4"),a=a(),v(),a),C={class:"left-container"},J={class:"btn-container"},R={class:"play-container"},A=r(()=>s("span",{class:"play-logo"},null,-1)),P={class:"play"},U={class:"time-container"},x=r(()=>s("span",{class:"time-logo"},null,-1)),F={class:"time"},B={class:"right-container"},E={key:1,class:"free"},q=r(()=>s("span",{class:"logo"},null,-1)),M=r(()=>s("p",null,"付费",-1)),$=[q,M],z=m({__name:"ChapterItem",props:["item"],setup(a){const h=u(),{chapter:I}=_(h),g=S(),f=e=>{O("添加到下载列表成功"),console.log(e);let t=JSON.parse(window.localStorage.getItem("downLoadList"));if(t){let n=e.bookId,i=t.find(o=>o.bookId==n);if(i)console.log("aaaaaa"),i.downLoadArr.find(o=>o.chapterId==e.chapterId)||(i.downLoadArr=[e,...i.downLoadArr],t=t.filter(o=>o.bookId!==i.bookId),window.localStorage.setItem("downLoadList",JSON.stringify([i,...t])));else{console.log("bbbbbb");let o={bookId:n,bookName:e.bookTitle,bookImg:e.bookImage,downLoadArr:[e]};window.localStorage.setItem("downLoadList",JSON.stringify([o,...t]))}}else{let n=[],o={bookId:e.bookId,bookName:e.bookTitle,bookImg:e.bookImage,downLoadArr:[e]};window.localStorage.setItem("downLoadList",JSON.stringify([o,...n]))}var l=new XMLHttpRequest;l.open("GET",e.chapterUrl,!0),l.responseType="blob",l.onload=function(n){if(this.status===200){var i=window.URL.createObjectURL(this.response),o=document.createElement("a");o.href=i,o.download=e.chapterTitle,o.click(),window.URL.revokeObjectURL(i)}},l.send()},k=e=>{if(e.chapterFreeStatus!=1){N("亲，这是付费内容！");return}let t=JSON.parse(window.localStorage.getItem("listenList"));t?t.find(n=>n.bookTitle==e.bookTitle)?(t=t.filter(n=>n.bookTitle!=e.bookTitle),t.unshift(e),window.localStorage.setItem("listenList",JSON.stringify(t))):(t.unshift(e),window.localStorage.setItem("listenList",JSON.stringify(t))):window.localStorage.setItem("listenList",JSON.stringify([e])),g.push({name:"play",query:{bookId:e.bookId,chapterId:e.chapterId}})};return(e,t)=>(c(),d("div",{class:"chapter-item",onClick:t[1]||(t[1]=l=>k(a.item))},[s("div",C,[s("h5",{class:b(["chapter-title",{active:a.item.chapterId==w(I).chapterId}])},p(a.item.chapterTitle),3),s("div",J,[s("div",R,[A,s("p",P,p(e.currentPlayTotal(a.item.chapterPlayNum)),1)]),s("div",U,[x,s("p",F,p(a.item.time),1)])])]),s("div",B,[a.item.chapterFreeStatus==1?(c(),d("a",{key:0,class:"download-logo",href:"javascript:;",download:"",onClick:t[0]||(t[0]=L(l=>f(a.item),["stop"]))})):(c(),d("div",E,$))])]))}});const H=T(z,[["__scopeId","data-v-a68a29a4"]]);export{H as C};
