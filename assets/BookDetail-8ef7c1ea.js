import{d as le,r as l,C as ne,c as g,a as e,v as h,n as M,b as i,w as v,q as u,o as p,y as ie,F as P,t as Y,g as j,p as ce,l as re,f as de,k as ve,_ as ue}from"./index-f321bc63.js";import{C as pe}from"./ChapterItem-c2d69b2f.js";import{T as _e}from"./TypeBook-bc10ca3f.js";import{o as me,f as G,q as he}from"./index-741193d7.js";import{a as H}from"./function-call-5517af3d.js";const _=k=>(ce("data-v-62a8ce1e"),k=k(),re(),k),ge={class:"book-container"},ke={class:"top-container"},fe={class:"nav"},be={class:"header-nav"},Ie={class:"book-msg-container"},ye={class:"book-msg"},we={class:"msg-top"},Se={class:"book-name"},Ne={class:"type-container"},Ce=_(()=>e("span",{class:"loading-type"},"连载",-1)),De={class:"type"},xe={class:"msg-bottom"},Be={class:"anchor-container"},Te={class:"header-container"},Je=_(()=>e("span",{class:"logo"},null,-1)),Oe={key:0,class:"love-logo aixin"},$e={key:1,class:"love-logo"},Le={class:"love-num"},qe={class:"bottom-container"},ze={class:"bottom-nav"},Re={class:"introduce-container"},Fe=_(()=>e("div",{class:"introduce-title"},[e("span",{class:"logo"}),e("p",{class:"title"},"书籍介绍")],-1)),Ue={class:"book-content"},Ve={class:"anchor-msg"},Ee=_(()=>e("div",{class:"anchor-title"},[e("span",{class:"logo"}),e("p",{class:"title"},"主播信息")],-1)),Ae={class:"anchor-container"},Me={class:"img-container"},Pe={class:"msg"},Ye={class:"anchor-name"},je={class:"chapter-box"},Ge=_(()=>e("span",{class:"play-logo"},null,-1)),He=_(()=>e("p",null,"一键播放",-1)),Ke=[Ge,He],Qe=_(()=>e("div",{class:"select-chapter"},[e("span",{class:"chapter-logo"}),e("p",null,"选集")],-1)),We={class:"recommend-container"},Xe=le({__name:"BookDetail",setup(k){const D=l(0),n=l("[]"),s=l("{}"),x=l("[]"),w=l(0),r=de(),K=ve(),f=l(),S=l(),N=l(!1),B=l(!1),b=l(1),T=()=>{me({bookId:r.params.bookId}).then(t=>{s.value=t.data.data}),G({bookId:r.params.bookId,page:b.value}).then(t=>{var o,c;n.value=(o=t.data.data)==null?void 0:o.list,w.value=(c=t.data.data)==null?void 0:c.total}),he({bookId:r.params.bookId}).then(t=>{x.value=t.data.data})},I=l(!1),Q=[{name:"微信",icon:"wechat"},{name:"微博",icon:"weibo"},{name:"复制链接",icon:"link"},{name:"分享海报",icon:"poster"}],W=t=>{H(t.name),I.value=!1};T();const X=()=>{f.value&&(window.scrollY?(f.value.style.opacity=1,S.value.style.filter="blur(10rem)"):(f.value.style.opacity=0,S.value.style.filter="blur(100rem)"))};window.addEventListener("scroll",X),ne(r,t=>{T()});const Z=()=>{n.value.length<w.value&&(b.value=b.value+1,G({bookId:r.params.bookId,page:b.value}).then(t=>{n.value=[...n.value,...t.data.data.list],N.value=!1,n.value.length>=w.value&&(B.value=!0)}))},y=l(!1),J=l("");J.value=JSON.parse(localStorage.getItem("collect1")||"[]"),(()=>{J.value.includes(r.params.bookId)&&(y.value=!0)})();const ee=()=>{var c,m;const t=l(""),o=l("");o.value=JSON.parse(localStorage.getItem("token")||"[]"),(m=(c=o.value)==null?void 0:c.tel)!=null&&m.length?(t.value=JSON.parse(localStorage.getItem("collect1")||"[]"),t.value.includes(r.params.bookId)?(t.value=t.value.filter(d=>d!=r.params.bookId),t.value=t.value.filter(d=>(d==null?void 0:d.bookId)!=r.params.bookId),localStorage.setItem("collect1",JSON.stringify([...t.value])),y.value=!1):(localStorage.setItem("collect1",JSON.stringify([...t.value,r.params.bookId,s.value])),y.value=!0)):H("请先登录")},te=()=>{let t=JSON.parse(window.localStorage.getItem("listenList"));t?t.find(c=>c.bookTitle==n.value[0].bookTitle)?(t=t.filter(c=>c.bookTitle!=n.value[0].bookTitle),t.unshift(n.value[0]),window.localStorage.setItem("listenList",JSON.stringify(t))):(t.unshift(n.value[0]),window.localStorage.setItem("listenList",JSON.stringify(t))):window.localStorage.setItem("listenList",JSON.stringify([n.value[0]])),K.push({name:"play",query:{bookId:n.value[0].bookId,chapterId:n.value[0].chapterId}})};return(t,o)=>{var O,$,L,q,z,R,F,U;const c=u("van-share-sheet"),m=u("van-loading"),d=u("van-image"),oe=u("van-text-ellipsis"),C=u("van-tab"),ae=u("van-list"),se=u("van-tabs");return p(),g("div",ge,[e("div",ke,[e("div",fe,[e("div",be,[e("span",{class:"back-logo",onClick:o[0]||(o[0]=a=>t.$router.back())}),e("p",{class:"book-title",ref_key:"title",ref:f},h((O=s.value)==null?void 0:O.bookTitle),513),e("span",{class:"share-logo",onClick:o[1]||(o[1]=a=>I.value=!0)}),e("div",{class:"mask",ref_key:"mask",ref:S,style:M({"background-image":`url(${s.value.bookImage})`})},null,4)])]),i(c,{show:I.value,"onUpdate:show":o[2]||(o[2]=a=>I.value=a),title:"立即分享给好友",options:Q,onSelect:W},null,8,["show"]),e("div",Ie,[i(d,{class:"img-container",width:"100rem",height:"100rem",fit:"cover",src:s.value.bookImage},{loading:v(()=>[i(m,{type:"spinner",size:"20"})]),_:1},8,["src"]),e("div",ye,[e("div",we,[e("p",Se,h(($=s.value)==null?void 0:$.bookTitle),1),e("div",Ne,[Ce,e("span",De,h((L=s.value)==null?void 0:L.categoryName),1)])]),e("div",xe,[e("div",Be,[e("div",Te,[i(d,{fit:"cover",width:"30rem",height:"30rem",src:(z=(q=s.value)==null?void 0:q.hostInfo)==null?void 0:z.userImage},{loading:v(()=>[i(m,{type:"spinner",size:"20"})]),_:1},8,["src"])]),e("p",{class:"writer",onClick:o[3]||(o[3]=a=>t.$router.replace({name:"anchorDetail",query:{id:s.value.hostId}}))},h((F=(R=s.value)==null?void 0:R.hostInfo)==null?void 0:F.userName),1),Je]),e("div",{class:"love-container",onClick:ee},[y.value?(p(),g("span",Oe)):(p(),g("span",$e)),e("p",Le,h((U=s.value)==null?void 0:U.collectTotal),1)])])])]),e("div",{class:"mask",style:M({"background-image":`url(${s.value.bookImage})`})},null,4)]),e("div",qe,[e("div",ze,[i(se,{active:D.value,"onUpdate:active":o[6]||(o[6]=a=>D.value=a),color:"#ee2b16",swipeable:"",background:"transparent"},{default:v(()=>[i(C,{title:"简介"},{default:v(()=>{var a,V,E,A;return[e("div",Re,[Fe,e("div",Ue,[i(oe,{rows:"5",content:s.value.bookDesc,"expand-text":"展开","collapse-text":"收起"},null,8,["content"])])]),e("div",Ve,[Ee,e("div",Ae,[e("div",Me,[i(d,{width:"50rem",height:"50rem",fit:"cover",src:(V=(a=s.value)==null?void 0:a.hostInfo)==null?void 0:V.userImage},{loading:v(()=>[i(m,{type:"spinner",size:"20"})]),_:1},8,["src"])]),e("div",Pe,[e("p",Ye,h((A=(E=s.value)==null?void 0:E.hostInfo)==null?void 0:A.userName),1),e("p",{class:"other-msg",onClick:o[4]||(o[4]=ie(et=>t.$router.push({name:"anchorDetail",query:{id:s.value.hostId}}),["stop"]))},"老铁们，来个关注好不好~")])])])]}),_:1}),i(C,{title:"章节"},{default:v(()=>[e("div",je,[e("div",{class:"chapter-container"},[e("div",{class:"header-nav"},[e("div",{class:"play-btn",onClick:te},Ke),Qe])]),i(ae,{loading:N.value,"onUpdate:loading":o[5]||(o[5]=a=>N.value=a),finished:B.value,"finished-text":"没有更多了",onLoad:Z,"immediate-check":!1},{default:v(()=>[(p(!0),g(P,null,Y(n.value,a=>(p(),j(pe,{key:a.chapterId,item:a},null,8,["item"]))),128))]),_:1},8,["loading","finished"])])]),_:1}),i(C,{title:"推荐"},{default:v(()=>[e("div",We,[(p(!0),g(P,null,Y(x.value,a=>(p(),j(_e,{class:"item",key:a.bookId,item:a},null,8,["item"]))),128))])]),_:1})]),_:1},8,["active"])])])])}}});const nt=ue(Xe,[["__scopeId","data-v-62a8ce1e"]]);export{nt as default};
